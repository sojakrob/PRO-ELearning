%\documentclass[11pt,oneside,a4paper]{book}
\documentclass[czech, 11pt, twoside, a4paper]{book}

\usepackage[czech, english]{babel}
\usepackage[T1]{fontenc}
\usepackage[cp1250]{inputenc}

\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{pifont}
\usepackage{array}
\usepackage{footmisc}
\usepackage{url}

\usepackage{k336_thesis_macros}

\usepackage{sojakrob_macros}

\lstset
{
language=CSharp,
classoffset=2,
morekeywords={ActionResult, UserTypes, AuthorizeUserType, PermissionException, UserPermissions, Form, ArgumentException, ArgumentNullException, UserPermissions, StudentPermissions, LectorPermissions, AdministratorPermissions, IUnityContainerAccessor, IUnityContainer}
}

\newcommand\TypeOfWork{Bakaláøská práce}  \typeout{Bakalarska prace}
\newcommand\StudProgram{Softwarové technologie a management, Bakaláøskı}
\newcommand\StudBranch{Softwarové inenırství}

\newcommand\WorkTitle{E-learningovı systém se zamìøením na testování}
\newcommand\FirstandFamilyName{Robert Soják}
\newcommand\Supervisor{Ing. Ondøej Macek}

\usepackage[
pdftitle={\WorkTitle},
pdfauthor={\FirstandFamilyName},
bookmarks=true,
colorlinks=true,
breaklinks=true,
urlcolor=red,
citecolor=blue,
linkcolor=blue,
%urlcolor=black,
%citecolor=black,
%linkcolor=black,
unicode=true,
]{hyperref}

\usepackage[square, numbers]{natbib}
%\usepackage{url}
%\DeclareUrlCommand\url{\def\UrlLeft{<}\def\UrlRight{>}\urlstyle{tt}}  %rm/sf/tt
%\renewcommand{\emph}[1]{\textsl{#1}}    % melo by byt kurziva nebo sklonene,
\let\oldUrl\url
\renewcommand\url[1]{<\texttt{\oldUrl{#1}}>}


\begin{document}
\selectlanguage{czech}

\iflanguage{czech}{
	 \typeout{************************************************}
	 \typeout{Zvoleny jazyk: cestina}
	 \typeout{Typ prace: \TypeOfWork}
	 \typeout{Studijni program: \StudProgram}
	 \typeout{Obor: \StudBranch}
	 \typeout{Jmeno: \FirstandFamilyName}
	 \typeout{Nazev prace: \WorkTitle}
	 \typeout{Vedouci prace: \Supervisor}
	 \typeout{***************************************************}
	 \newcommand\Department{Katedra poèítaèù}
	 \newcommand\Faculty{Fakulta elektrotechnická}
	 \newcommand\University{Èeské vysoké uèení technické v Praze}
	 \newcommand\labelSupervisor{Vedoucí práce}
	 \newcommand\labelStudProgram{Studijní program}
	 \newcommand\labelStudBranch{Obor}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%    Titulni stranka / Title page 

\coverpagestarts

%%%%%%%%%%%%%%%%%%%%%%%%%%%    Podekovani / Acknowledgements 

\acknowledgements
\noindent


%%%%%%%%%%%%%%%%%%%%%%%%%%%   Prohlaseni / Declaration 

\declaration{V~Praze dne }

%%%%%%%%%%%%%%%%%%%%%%%%%%%%    Abstract 
 
\abstractpage



\vglue60mm
\noindent{\Huge \textbf{Abstrakt}}
\vskip 2.75\baselineskip

\noindent


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Obsah / Table of Contents 

\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Seznam obrazku / List of Figures 

\listoffigures

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Seznam tabulek / List of Tables

\listoftables

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  Seznam zdrojovych kodu / List of Source Codes

\lstlistoflistings

%**************************************************************

\mainbodystarts
% horizontalnÃ­ mezera mezi dvema odstavci
%\parskip=5pt
%11.12.2008 parskip + tolerance
\normalfont
\parskip=0.2\baselineskip plus 0.2\baselineskip minus 0.1\baselineskip


%*****************************************************************************
\chapter{Úvod}

Tento projekt e-learningového\footnote{Vzdìlávání za pomoci moderních elektronickıch informaèních a komunikaèních technologií} systému vznikl na základì poptávky neziskové organizace. Má slouit jako nástroj pro nauèné testování úèastníkù (dále \textit{studentù}) kurzù, které organizace poøádá.

V souèasné dobì organizace vyuívá pro testování Google Formuláøù\footnote{Názvem Google Formuláø zde znaèím formuláø tabulkového procesoru z rodiny Google Dokumentù} \cite{GoogleDocuments} s testovımi otázkami, kde student vybírá právì jednu odpovìï z nìkolika monıch. Skrze automaticky generovanou tabulku odpovìdí jednotlivıch studentù je sice koordinátor kurzu (dále \textit{lektor}) schopen vyhodnotit správnost odpovìdí, ale to je vše, co mu aplikace Formuláøù umoòuje. Vısledky je nucen ruènì vyhodnotit a danému studentovi nastínit správné odpovìdi nebo alespoò odkázat na související kapitolu v uèebním materiálu (dále \textit{skripta}).

Pro kategorizaci studentù a pøíslušnıch lektorù je v organizaci vyuito Google Skupin.

\section{Cíl projektu}

Cílem projektu je vyvinout portál pro podporu vıuky. Hlavní funkcionalitou by mìla bıt tvorba a vyplòování nauènıch testù urèenıch skupinám studentù. Systém by mìl také podporovat tvorbu a správu elektronickıch skript.

Jakoto bakaláøská práce by mìl projekt také ukázat mou schopnost samostatnì øešit danı problém. Chtìl bych pøedvést nabyté znalostí a schopnost vyuít moderní technologie pøi jeho realizaci.

\section{Vyuití}

Vıslednı systém by mìl bıt nasazen do zmínìné poptávající neziskové organizace.

Má ale i širší vyuití, protoe dává za vznik univerzálnímu e-learningovému portálu. Systém nauènıch testù (rozebrán ve~\ref{sec:Popis problému} a~\ref{sec:Typy formuláøù}) je zde svım zpùsobem originální a odlišuje portál od ostatních aplikací tohoto typu.

Já osobnì bych chtìl portál vyuít jako nástroj pro podporu vıuky studentù informatiky na gymnáziu, kde pùsobím jako uèitel. Oèekávám od nìj efektivní pomoc pøi tvorbì a známkování testù a sdílení studijních materiálù.

Mùe bıt pøínosem i pro další pøedmìty jako jednoduše ovladatelnı nástroj pro tvorbu tištìnıch testù èi dotazníkù, které jsou povìtšinou tìkopádnì tvoøeny v textovém procesoru. Nastavil by se tím i jednotnı vzhled, kterı má kadı kantor odlišnı.

\section{Obsah práce}

V této práci se dále vìnuji analıze vısledného systému, kde ukazuji svùj postup pøi shromaïování poadavkù, rešerši podobnıch systémù a promıšlení celkové funkcionality. Poté zde pøedstavuji návrh architektury systému a potøebnıch entit. Na to navazuji popisem implementace, kde zmiòuji nìkteré postupy a konkrétní øešení nìkterıch èástí aplikace. Vìnuji se také testování a nasazení hotového portálu. Nakonec uvádím moná rozšíøení a celkové zhodnocení.
 

%*****************************************************************************
\chapter{Analıza}
\label{chp:Analıza}

Pøi analıze zde nejdøíve shromaïuji a popisuji poadavky na vıslednı systém. Poté se vìnuji rešerši ji existujících systémù, abych získal pøehled, co v souèasné dobì nabízejí a jak vypadají. To napomáhá k jasnìjšímu pohledu na moná øešení pro splnìní danıch poadavkù. Dále rozebírám konkrétní øešení mého systému.

\section{Popis problému}
\label{sec:Popis problému}

Jak ji vyplıvá z úvodu, organizace potøebuje aplikaci pro tvorbu, vyplnìní, okamité vyhodnocení a okomentování testù. Ty zde znaèím jako \textit{nauèné testy}.

Lektor kurzu vytvoøí šablonu testu s otázkami o nìkolika monıch odpovìdích. Ke kadé otázce by mìl mít monost napsat slovní komentáø, ve kterém mùe nastínit, proè je daná odpovìï správnì nebo špatnì a pøípadnì odkázat na studijní materiál, kterı danou problematiku vysvìtluje. Kadá otázka k sobì mùe vázat otázky alternativní, které test inovují pøi vyplòování stejného testu vícekrát.

Student by mìl mít vdy pøehled o dostupnıch testech, které jsou urèené pro kurzy, do nich je zaøazen. Po konkrétním vıbìru se pro nìj test vygeneruje z dostupnıch otázek a jejich alternativ. Vdy, kdy testovanı oznaèí svou odpovìï, zobrazení se vysvìtlení správné odpovìdi a dojde k jejímu viditelnému zvıraznìní. Po vyplnìní celého testu èi pouze jeho èásti má student monost odeslat svùj vısledek nadøízenému lektorovi. Ten má ve vısledku pøehled, jak na tom jeho svìøenci se znalostmi jsou.

\section{Poadavky na systém}

Poadavky na vıslednı e-learningovı systém sestávají ze základních poadavkù zadávající organizace (\ref{sec:Popis problému}) a rozšiøujících poadavkù. Rozšiøující poadavky byly sestaveny na základì obecnıch poadavkù na systém takového typu a inspirací zmínìnıch v rešerši v následující sekci~\ref{sec:Rešerše existujících øešení}. Díky tìmto rozšiøujícím poadavkùm by mìl vzniknout zmínìnı komplexnìjší univerzální e-learningovı systém.

\subsection{Poadavky zadavatele}
\label{subs:Poadavky zadavatele}

\subsubsection{Funkèní poadavky}

\begin{enumerate}[FP1.] \setlength\itemindent{15pt}
\item Tvorba testù s vıbìrovımi otázkami s právì jednou správnou odpovìdí
\item Zobrazení vısledku testu a~monost jeho odeslání lektorovi kurzu
\item Kadá otázka mùe sestávat z nìkolika variací
\label{FP:Kadá otázka mùe sestávat z nìkolika variací}
\item Náhodnı vıbìr variace otázky pøi generování testu
\item Zobrazení komentáøe k~právì zodpovìzené otázce (cca odstavcovı)
\label{FP:Zobrazení komentáøe k právì zodpovìzené otázce (cca odstavcovı)}
\item Neomezenı poèet moností danı test opakovat dokud nebude zodpovìzen správnì
\item Monost kategorizace studentù, lektorù a pøíslušnıch testù do skupin
\newcounter{FPEnum} \setcounter{FPEnum}{\theenumi}
\end{enumerate}

\subsubsection{Nefunkèní poadavky}

\begin{enumerate}[NP1.] \setlength\itemindent{15pt}
\item Jednoduché ovládání, pochopitelné pro bìného uivatele i bez zaškolení
\label{NP:Jednoduché ovládání, pochopitelné pro bìného uivatele i bez zaškolení}
\newcounter{NPEnum} \setcounter{NPEnum}{\theenumi}
\end{enumerate}

\subsection{Rozšiøující poadavky}

\subsubsection{Funkèní poadavky}

\begin{enumerate}[FP1.] \setlength\itemindent{15pt}
\setcounter{enumi}{\theFPEnum}
\item Rozšíøení o více typù testù (obecnì \textit{formuláøù})
\item Monost vıbìru z více typù otázek
\item Lektor mùe ohodnotit pøijatı formuláø
\item Podpora exportu vısledkù formuláøù do Google Formuláøù
\label{FP:Podpora exportu vısledkù formuláøù do Google Formuláøù}
\item Podpora tisku prázdnıch i vyplnìnıch formuláøù
\item Monost tvorby elektronickıch skript
\item Podpora importu studentù z Google Skupin~\cite{GoogleGroups}
\end{enumerate}

\subsubsection{Nefunkèní poadavky}

\begin{enumerate}[NP1.] \setlength\itemindent{15pt}
\setcounter{enumi}{\theNPEnum}
\item Vıslednı systém je webová aplikace postavená na ASP.NET MVC
\label{NP:Vıslednı systém je webová aplikace postavená na ASP.NET MVC}
\end{enumerate}


\section{Rešerše existujících øešení}
\label{sec:Rešerše existujících øešení}

Rešerši existujících øešení e-learningovıch a tvorbou formuláøù zabıvajících se aplikací jsem neprovádìl za úèelem nalezení kandidáta na rozšíøení o poadovanou funkcionalitu. Rešerši zde uvádím s cílem prozkoumat dostupná øešení, zjistit co poskytují za sluby a tøeba je vyuít pro inspiraci. Projekt byl ji od zaèátku zamıšlen pro vznik takøíkajíc na zelené louce. Jedním z dùvodù je funkcionalita speciálního nauèného testu (\ref{sec:Popis problému},~\ref{sec:Typy formuláøù}). Dalším dùvodem je poadavek na jednoduché ovládaní a zkušenost uivatelù ze zadávající spoleènosti s prostøedím Google Formuláøù. Hlavním dùvodem je ale myslím moje snaha zapojit do vıvoje znalosti softwarového inenırství a touha vytvoøit si systém vlastní. Nechtìl jsem jen vybrat z pøedpøipraveného øešení s hotovou architekturou a pøibalit k ní plugin pro práci s nauènımi testy.

\subsection{Google Formuláøe}

Jako Google Formuláø v této bakaláøské práci znaèím formuláø tabulkového procesoru z balíku Google Dokumenty~\cite{GoogleDocuments} (na Obr.~\ref{fig:Hlavní stránka Google Dokumentù}). Pomocí poskytovaného nástroje je uivateli umonìno vytvoøit vlastní formuláø z nìkolika monıch formuláøovıch prvkù. Hotovı formuláø lze  poté zveøejnit (zcela nebo jen pro urèitı okruh uivatelù) a nechat jej vyplnit. Odpovìdi jsou automaticky zapisovány do tabulky, kde jsou spolu s dalšími informacemi (napø. datum a èas vyplnìní) pøipravené pro další analızu.

Základní myšlenka tohoto projektu vychází právì z Google Formuláøù (lidé od zadavele jsou na nì zvyklí), proto zde jejich rozebrání vìnuji více prostoru.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/GoogleDocs}
\caption{Hlavní stránka Google Dokumentù}
\label{fig:Hlavní stránka Google Dokumentù}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/GoogleFormsSampleForm}
\caption{Ukázka Google Formuláøe: tvorba vlevo, vısledek vpravo}
\label{fig:Ukázka Google Formuláøe}
\end{center}
\end{figure}

\subsubsection{Tvorba formuláøe}

Tvorba formuláøe (viditelná na obr.~\ref{fig:Ukázka Google Formuláøe}) probíhá v, øekl bych, náhledovém reimu -- uivatel vidí formuláø témìø stejnì jako koncovı uivatel, jen nemùe vyplòovat odpovìdi a otázky mùe jednotlivì upravovat. Úpravy se provádìjí dynamicky pomocí Javascriptu a vše je automaticky ukládáno.

Otázka se skládá z nadpisu, textu nápovìdy, volby typu otázky a zda je otázku povinné vyplnit. Nepovinnı údaj je text nápovìdy a dokonce i nadpis otázky, take pøi nevyplnìní vidí koncovı uivatel jen prázdné pole èi vıèet odpovìdí (v závislosti na typu otázky).

\subsubsection{Typy otázek}

Následuje vıèet otázek, které lze na Google Formuláø umístit, a pouitelnost daného typu otázky ve vyvíjeném systému.

%TODO dopsat pouzitelnost:

\begin{description}
\item[Text] Krátkı text, tázanı uivatel zapisuje odpovìï do krátkého pole input\footnote{Formuláøovı element HTML}, které u dále nemìní svou velikost.
\item[Text odstavce] Pro tázaného zobrazen jako textarea, která se pøizpùsobuje délce zapisovaného textu.
\item[Více moností] Jednoduchı vıèet pomocí radio buttonù pro vıbìr jedné odpovìdi.
\item[Zaškrtávací políèka] Vıèet pomocí checkboxù, monost vybrat ádnou èi více odpovìdí.
\item[Vyberte ze seznamu] Zobrazí uivateli combo box s vıètem moností. Vlastnì stejná funkènost jako Více moností, ale zabírá ménì místa, jednotlivé odpovìdi nejsou stále vidìt.
\item[Mìøítko] Umoòuje zvolení hodnoty ze zvoleného rozsahu, napøíklad 1--5. Tázanému je vıbìr umonìn pomocí radio buttonù.
\item[Møíka] V podobì tabulky dává monost zvolit pro kadı øádek jednu hodnotu umístìnou ve sloupcích. Je zde ale omezení, sloupcù mùe bıt max. 5 a pro jeden øádek nelze umonit zvolení více hodnot najednou.
\end{description}

\subsubsection{Uivatelské rozhraní}

Protoe uivatelé zadavatele jsou ji zvyklí na rozhraní Google Dokumentù (na obr.~\ref{fig:Hlavní stránka Google Dokumentù} a~\ref{fig:Ukázka Google Formuláøe}) a toto rozhraní zároveò splòuje NP\ref{NP:Jednoduché ovládání, pochopitelné pro bìného uivatele i bez zaškolení}, mìlo by bıt grafické rozhraní e-learningového portálu podobné. Alespoò co se tıèe rozloení a umístìní ovládacích prvkù.

\subsection{Moodle}
\label{sec:Moodle}

Moodle~\cite{MoodleORG} je asi nejznámìjší a celosvìtovì rozšíøené prostøedí pro elektronickou podporu vıuky. Je to soubor mnoha modulù, které lze vyuít pro sestavení a nasazení vlastního vıukového portálu. K dispozici je jako open source pod GNU GPL\footnote{GNU General Public Licence, èesky všeobecná veøejná licence GNU} licencí.

Jeho moduly umí snad vše, co se od takového systému oèekává -- od distribuce studijních materiálù pøes tvorbu a vyhodnocování testù po diskuzní fóra. Jakékoli další moduly lze samozøejmì doprogramovat.

Z pohledu uivatele se mi zdá Moodle hodnì sloitı. Kadá obrazovka chrlí velké mnoství rùznıch nabídek, dat a moností. Nezkušenı uivatel musí bıt doslova zavalen, nemluvì o vyuèujících, kteøí mají k dispozici podstatnì více akcí a nastavení. Mnoství z nich je pøístupné jen formou malıch ikonek u jednotlivıch poloek, co nutí orientovat se pomocí tooltipù. Zaèínající uivatel role studenta má ještì monost po chvíli nalézt co hledá, ale lektor to má mnohem tìší. Bìní uivatelé, kteøí mají problém pouívat akce textového procesoru, musí bıt v systému bez externí pomoci zcela ztraceni. Tomu se právì snaím v mém systému vyhnout.

\subsubsection{Otázky do testù}

V systému Moodle jsou otázky pojaty trochu jinım zpùsobem, ne mùeme oèekávat u pøímoèarého tvùrce formuláøù (jako je napø. vıše popisovanı Google Formuláø). Nejsou toti vázány na jednotlivé testy, ale existují v tzv. otázkovıch bankách k urèitému kurzu. Dále se dají øadit do kategorií a také sdílet s dalšími kurzy a vyuèujícími.

Ve vyvíjeném e-learningovém systému se mi ale takovı zpùsob nezdá bıt pøínosem. Myslím si, e pro uivatele by bylo zbyteènì sloité øadit otázky do mnoství skupin a posléze kadému formuláøi tyto skupiny otázek nastavovat.

Systém obsahuje velké mnoství typù otázek, které vlastnì rozšiøují základní bìnì pouívanou mnoinu o specifiètìjší (jako napø. spojování). Vıèet pøikládám v pøíloze \ref{fig:Typy otázek v systému Moodle}.

\subsection{Studentova berlièka}

Studentova Berlièka je jeden z projektù studentù ÈVUT FEL. Jedná se o informaèní systém pro podporu vıuky na škole. Vıvoj zaèal bakaláøskou prací \cite{StudentovaBerlickaI} v roce 2007 a poté byl systém dále rozvíjen a obohacován o další funkcionalitu. Zamìøil jsem se na modul pro generování testù \cite{StudentovaBerlicka_ModulProGenerovaniTestu}.

Jednotlivé otázky jsou zde, podobnì jako v Moodle, øazeny do tematickıch okruhù. Otázky do testu jsou vybírány z jednoho èi více okruhù. Typy otázek jsou zde dva, slovní odpovìï a vıbìrová. 

Zajímavé je zde øešení postupu pøi tvorbì jednotlivıch otázek. Otázka se mùe nacházet v jednom z tìchto stavù:
\begin{itemize}
\item Rozpracované
\item Mùj lokál
\item K validaci
\item Ke schválení
\item Schválené
\end{itemize}

Jak je ji z vıètu stavù zøejmé, proces tvorby je uzpùsoben pro kooperaci více uivatelù, napøíklad cvièících a pøednášejícího. Cvièící pøipravují otázky, které následnì pøednášející schvaluje. 

Aèkoli je tento postup tvorby otázek pro vysokou školu urèitì ádoucí, pro mnou vyvíjenı systém by byl nadbyteènı. V doménì uivatelù poèítám s jedním vedoucím skupiny, kterı testové otázky sám vytváøí. Z tohoto dùvodu také v systému neøeším moné kolize pøi editování více uivateli naráz, co v tomto modulu Studentovi berlièky øešeno je.

\subsection{Závìr}

V této sekci jsem popsal nìkteré systémy, které jsem prostudoval za úèelem zjištìní nabízenıch slueb a zpùsobu jejich realizace. Hlavní inspirací pro základ e-learningového systému jsou pro mì Google Formuláøe. Obsahují všechny základní typy otázek potøebné pro vytváøení formuláøù a jsou jednoduše ovladatelné. Naproti tomu Moodle mi ukazuje portál, kterému bych se blíit nechtìl. Obsahuje velké mnoství rùznıch funkcí, kterıch by v mé cílové skupinì vyuilo moná procento uivatelù. Navíc je pro nì podle mì dosti sloitı na ovládání.

\section{Uivatelské role}

Uivatelské role potøebné v systému jasnì plynou ji ze zadání, jsou to tyto tøi role:

\begin{description}
\item[Student] Pøedstavuje úèastníka kurzu z domény zadavatele a obecnì studenta vyuívajícího e-learningového systému. Z hlediska práv v aplikaci je na nejniší úrovni, tzn. všechny jeho akce se vztahují pouze k nìmu samotnému. Mezi akce patøí napøíklad vyplòování testù dostupné pro jeho skupinu a prohlíení vısledkù svıch testù (více v sekci~\ref{sec:Pøípady uití}).
\item[Lektor] Lektorem je koordinátor kurzu z domény zadavatele, vedoucí jedné èi více skupin (neboli \textit{kurzù}). Obecnì se tedy jedná o uèitele studentù, kterı má na starost tvorbu testù pro jeho skupiny a jejich následné ohodnocení.
\item[Administrátor] Uivatelská role známá asi ze všech systémù. Je to správce celého portálu a supervizor lektorù. Jako takovı má práva všech lektorù a k tomu dostupnou funkcionalitu pro administraci aplikace vèetnì pøidávání uivatelù a tvorby skupin.
\end{description}

\section{Pøípady uití}
\label{sec:Pøípady uití}

Na diagramu~\ref{fig:Diagram uití} jsou zachyceny základní operace provádìné uivateli v danıch rolích zastoupenıch aktéry pøípadù uití. Slovní popis vybranıch pøípadù uití je umístìn v pøíloze~\ref{appendix:Pøípady uití}. Ostatní jsou realizovány pomocí Selenium testù, které jejich scénáøe jasnì vystihují. Vıpis je umístìn v tabulce~\ref{tab:TabulkaPøípadùUití}.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/UseCaseDiagram}
\caption{Diagram uití}
\label{fig:Diagram uití}
\end{center}
\end{figure}

\begin{table}[h]
\begin{center}
\begin{tabular}{!{\bvline}l!{\vline}c|c!{\bvline}} \bhline
 \textbf{Pøípad uití} & \textbf{Textovı popis} (\ref{appendix:Pøípady uití}) & \textbf{Selenium test} (\ref{sec:Selenium testy}) \\ \bhline
Pøihlásit se do systému & \cross & \cross \\
Odhlásit se ze systému & & \cross \\
Zobrazit formuláøe & & \cross \\
Vytvoøit novı formuláø & \cross & \cross \\
Upravit existující formuláø & & \\
Pøídat/zmìnit/smazat otázku & \cross & \\
Pøiøadit formuláø skupinì & & \cross \\
Exportovat vısledky formuláøe & \cross & \\
Zobrazit dostupné formuláøe & & \cross \\
Vyplnit formuláø  & \cross & \\
Zobrazit vısledky formuláøù & & \\
Zobrazit skripta & & \\
Vytvoøit nová skripta & & \\
Upravit existující skripta & & \\
Pøidat studenta do systému & & \\
Pøiøadit studenta do skupiny & & \\
Vytvoøit skupinu & & \\
Pøídat lektora do systému & & \\ \bhline
\end{tabular}
\end{center}
\caption{Rozpis pouitıch definic pro jednotlivé pøípady uití}
\label{tab:TabulkaPøípadùUití}
\end{table}

\section{Formuláøe}
\label{sec:Formuláøe}

Formuláøe pøedstavují základní nástroj tohoto e-learningového portálu. Slouí jak lektorùm pro otestování znalostí jejich ákù, tak pro studenty samotné jako nástroj pro nauku a zpìtnou vazbu.

Kadı formuláø je moné pøiøadit do libovolného mnoství skupin. Vede-li lektor více skupin, má monost urèit jako cílové skupiny formuláøe jejich podmnoinu. Studenti potom mají pøístup ke všem formuláøùm z jim pøiøazenıch skupin.

Mezi další monosti, které formuláøe obsahují, patøí napøíklad nastavení èasového limitu pro jeho vyplnìní èi zamíchání jednotlivıch otázek a odpovìdí. Více je popsáno v sekci~\ref{sec:Monosti nastavení formuláøù}.

ivotní cyklus formuláøe (viz. Obr.~\ref{fig:Stavovı diagram formuláøe}) zaèíná jeho zaloením lektorem a pøechází do stavu \textit{Neaktivní editovatelnı}. V tuto chvíli jsou nastaveny monosti formuláøe a vytváøeny otázky. Aby byl viditelnı pro studenty z pøiøazenıch skupin, musí bıt uveden do stavu \textit{Aktivní nevyplnìnı}. Pro opìtovné pozastavení formuláøe je moné pøejít zpìt do \textit{Neaktivního} stavu. V pøípadì, e byl ji test nìkım vyplnìn, pohybuje se mezi stavy \textit{Aktivní vyplnìnı} a \textit{Neaktivní needitovatelnı}. V tìchto stavech u není formuláø moné editovat. Nakonec formuláø pøechází do stavu \textit{Archivován}.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.5\textwidth]{figures/FormStateDiagram}
\caption{Stavovı diagram formuláøe}
\label{fig:Stavovı diagram formuláøe}
\end{center}
\end{figure}

\subsection{Typy formuláøù}
\label{sec:Typy formuláøù}

Základní mnoinu formuláøù systému tvoøí tyto tøi typy:

\begin{description}
\item[Nauènı test] Je to netradièní typ testu vycházející z poadavkù zadavatele. Ke kadé otázce je moné pøidat vysvìtlení správné odpovìdi (FP\ref{FP:Zobrazení komentáøe k právì zodpovìzené otázce (cca odstavcovı)}), které je vyplòujícímu studentovi zobrazeno po oznaèení odpovìdi, kterou povauje za správnou. Test tedy plní dvì funkce, vypovídá o souèasnıch znalostech studenta a jeho pøipravenosti na monı zkouškovı test. Zároveò ho opravuje a smìruje správnou cestou. Test je moné vyplnit vícekrát. Díky alternativním otázkám (FP\ref{FP:Kadá otázka mùe sestávat z nìkolika variací}) není pokadé stejnı.
\item[Zkouškovı test] Toto je bìnı test pro ostré otestování studentovıch znalostí, jak ho známe ze všech vzdìlávacích institucí. Mùe mít navíc urèen napøíklad èasovı limit pro dokonèení èí monost více pokusù pro správné vyplnìní.
\item[Dotazník] Plní funkci bìného dotazníku. Kadı ho smí vyplnit pouze jedenkrát.
\end{description}

\subsection{Monosti nastavení formuláøù}
\label{sec:Monosti nastavení formuláøù}

Monosti nastavení chování jednotlivıch typù formuláøù shrnuje následující tabulka~\ref{tab:Monosti chování formuláøù}.

\begin{table}[h]
\begin{center}
\begin{tabular}{!{\bvline}l!{\bvline}c|c|c!{\bvline}} \bhline
 & \textbf{Nauènı test} & \textbf{Zkušební test} & \textbf{Dotazník} \\ \bhline
Èas na vyplnìní & \tick & \tick & \cross \\ \hline
Zamíchaní otázek & \tick & \tick & \cross \\ \hline
Zamíchaní nabízenıch odpovìdí & \tick & \tick & \cross \\ \hline
Vysvìtlení správné odpovìdi & \tick & \cross & \cross \\ \hline
Monost vyplnit vícekrát & \tick & \tick & \cross \\ \bhline
\end{tabular}
\end{center}
\caption{Monosti chování formuláøù}
\label{tab:Monosti chování formuláøù}
\end{table}

\section{Otázky}
\label{sec:Otázky}

Otázky tvoøí náplò formuláøù. Kadá z otázek k sobì mùe vázat další, alternativní otázky. Kdy je pro studenta generován test, právì jedna alternativní otázka je vybrána. Jestlie tedy test obsahuje otázky s více alternativami, budou jednotlivé vygenerované testy rozdílné.

Jednotlivé otázky formuláøe mohou bıt lektorem libovolnì tvoøeny, duplikovány, upravovány a mazány. Ovšem jen do okamiku, kdy je formuláø pøeveden do stavu \textit{aktivní} a vyplnìn nìkterım ze studentù. V tom pøípadì u otázky nesmìjí bıt upravovány a mazány, aby mìli všichni stejné podmínky a nemìnily se jim otázky \uv{pod rukama}.

Monost duplikace otázek je zavedena hlavnì kvùli vıbìrovım otázkám \ref{item:Vıbìrová otázka}. Duplikací otázky tak odpadá nutnost opakovaného vkládání totonıch odpovìdí.

\subsection{Typy otázek}

Mnoina typù jednotlivıch otázek je sestavena z potøeby zadavatele, èím je otázka vıbìrová, a základních potøeb univerzálního e-learningového systému. Mnoina tedy obsahuje 5 typù otázek, z èeho 3 typy jsou základní. Moné další  otázky vhodné pro rozšíøení systému jsou nastínìny v sekci~\ref{sec:Moná rozšíøení sub:Otázky}.

\begin{description}

\item[Vıbìrová otázka] \label{item:Vıbìrová otázka} \hfill
\begin{description}
\item[Jedna správná odpovìï] Právì jedna z mnoiny nabízenıch odpovìdích je správná.
\item[Více správnıch odpovìdí] ádná nebo více z nabízenıch odpovìdí je správná.
\end{description}

\item[Textová otázka] \hfill
\begin{description}
\item[Krátká] Od vyplòujícího studenta se oèekává jednoslovná èi jednovìtná odpovìï.
\item[Dlouhá] Zde se oèekává vyèerpávající odpovìï, tzn. jedna a více vìt.
\end{description}
\item[Rozsahová otázka] Odpovìï je tøeba vybrat z definovaného rozsahu, napø. známka 1--5, hodnocení 0--10. Tento typ otázky je hlavnì pro potøebu dotazníku.
\end{description}

\section{Skripta}
\label{sec:Skripta}

Skripta hrají v systému roli elektronickıch uèebních materiálù. Kategorizována jsou stejnì jako formuláøe, tzn. do skupin existujících v systému, take studenti mají k dispozici materiály vıhradnì k jim pøiøazenım kurzùm. Skripta by mìla bıt vytváøena pøevánì lektory pro studenty. Monost jejich tvorby ale není studentùm odepøena, mohou je vyuít napøíklad pro tvorbu osobních zápiskù z hodin. Mají také monost vytvoøená skripta zveøejnit pro ostatní èleny skupiny.

Skripta je moné formátovat do strukturované podoby, tzn. monost tvorby nadpisù, odstavcù, odkazù, tabulek, monost volby stylu písma a další. K tomuto úèelu by mìl bıt k dispozici editor pouívající Wiki znaèkování\footnote{Syntaxe a klíèová slova vyuívaná k formátování textu na stránce}, která je snad pro vìtšinu uivatelù pochopitelná a lehce nauèitelná. S pomocí tlaèítek pro automatické formátování vybraného textu nemusí mít ani uivatel potøebu proèítat dokumentaci k pouívání daného Wiki znaèkování.

\chapter{Návrh}

\section{Architektura systému}
\label{sec:Architektura systému}

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.8\textwidth]{figures/Architecture}
\caption{Architektura systému}
\label{fig:Architektura systému}
\end{center}
\end{figure}

Architektura systému (Obr.~\ref{fig:Architektura systému}) je spojením architektury tøívrstvé a MVC\footnote{Model View Controller} (Obr.~\ref{fig:Architektura MVC}). Pouití MVC jasnì vyplıvá ji z NP\ref{NP:Vıslednı systém je webová aplikace postavená na ASP.NET MVC}. Ovšem architektura MVC sama o sobì podle mì o celkové struktuøe systému nevypovídá mnoho. Pod pojem Model toti skrıvá nìkolik rùznorodıch komponent systému, konkrétnì napøíklad business logiku (její èást ale bıvá také v Controlleru) a datové uloištì. A protoe Model, View i Controller bıvají v praxi velmi provázané, je nemoné jednu z komponent vymìnit za jinou s rozdílnou implementací bez zásahu do ostatních.

Já tedy vyuívám MVC jako \uv{prezentaèní} vrstvu z pohledu tøívrstvé architektury. Mohu toti tuto vrstvu kdykoli vymìnit napøíklad za Windows Forms, èím vznikne desktopová aplikace vyuívající totonou business a datovou vrstvu.

Business vrstva je ji standartní vrstva tøívrstvé architektury, která obstarává veškerou aplikaèní logiku a zprostøedkovává prezentaèní vrstvì zpracovaná data.

Datová vrstva obsahuje celı datovı model systému a také komponenty potøebné pro CRUD\footnote{Create, Read, Update \& Delete - ètyøi základní operace datového uloištì} operace s tìmito daty.

\section{Datová vrstva}

Na Meta modelu (Obr.~\ref{fig:Meta model}) jsou vidìt základní entity modelovaného systému a vztahy mezi nimi. Za zmínku stojí \icode{FormTemplate} a \icode{QuestionGroup}. První jmenovaná entita zastupuje šablonu formuláøe, na jejím základì jsou generovány jednotlivé instance (neboli konkrétní sestavy) formuláøe, pøedstavující unikátní formuláø urèenı k jednomu vyplnìní studentem. \icode{FormTemplate} obsahuje kolekci druhé jmenované entity \icode{QuestionGroup}, co je skupina otázek (otázka a její alternativy, viz. \ref{sec:Otázky}). Do instance formuláøe se vybírá právì jedna otázka z této mnoiny.

Návrhovı model na obrázku \ref{fig:Design model datové vrstvy} ukazuje podrobnìjší návrh objektù datové vrstvy. U jednotlivıch objektù jsou vypsány jejich základní vlastnosti, se kterımi by mìl systém umìt pracovat pro dosaení poadované funkcionality analyzované v kapitole \ref{chp:Analıza}.

Mimo jiné bylo nutné pøidat vlastní objekt instance otázky (\icode{QuestionInstance}), kterı je tøeba pro zachycení pozice otázky ve formuláøi (jeliko je moné pøi generování instance testu nechat otázky promíchat). Další zanesenou entitou je \icode{Answer} zastupující odpovìï na otázku a \icode{FormInstanceEvaluation} tvoøící ohodnocení instance formuláøe. Pøibyl také objekt \icode{ChoiceItem}, co je poloka moné odpovìdi na otázku typu vıbìrová (\ref{item:Vıbìrová otázka}). 

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.9\textwidth]{figures/MetaModel}
\caption{Meta model}
\label{fig:Meta model}
\end{center}
\end{figure}

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/DesignModel}
\caption{Návrhovı model datové vrstvy}
\label{fig:Design model datové vrstvy}
\end{center}
\end{figure}

\section{Business vrstva}

Jak ji bylo øeèeno vıše, business vrstva obsahuje veškerou logiku tohoto e-learningového systému a operace pro práci s daty získané pomocí datové vrstvy. Jeliko obsahuje rùznorodé komponenty, je rozdìlena do nìkolika balíèkù, které jsou i se svım obsahem patrné z diagramu na obrázku \ref{fig:BusinessPackages}.

\subsection{Rozpis balíèkù}

\begin{description}
\item[Managers] Balíèek obsahující tøídy, které nazıvám \uv{manaery}. Mají za úkol poskytovat funkcionalitu pro práci s jim svìøenou datovou entitou z datové vrstvy, napøíklad \icode{TextBookManager} obsahuje implementaci spojenou se skripty a \icode{GroupManager} se skupinami.
\item[Permissions] Zde je místo pro práva-definující tøídy. O implementaci s nimi spojené je více popsáno v sekci \ref{sec:Práva uivatelù}.
\item[Storages] V tomto balièku jsou umístìny tøídy tıkající se ukládacích prostorù. Lokální pro odkládání dat napø. pøi exportu a \icode{WebStorage} pro zapouzdøení pøístupu k datùm v databázi ve webovém prostøedí.
\item[Reporting] Balíèek slouící k reportování vısledkù vyplnìnıch formuláøù.
\item[ImportExport] V ImportExport balíèku se nacházejí tøídy pro import dat do systému a export ze systému. Vnoøenı balíèek Google se vìnuje pøedávání dat s Google slubami.
\item[Interfaces] Obecnı balíèek pro rùzná rozhraní, která není nutné dìlit do vìtších kontextù.
\item[Exceptions] Zde se nacházejí specifické vıjimky systému.
\end{description}

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/BusinessPackages}
\caption{BusinessPackages}
\label{fig:BusinessPackages}
\end{center}
\end{figure}

\section{ASP.NET MVC vrstva}

Tato vrstva staví na modelu MVC (na Obr. \ref{fig:Architektura MVC}) tvoøícím podstatu technologie ASP.NET MVC. Základem je zde tedy view, controller a model.

Pohledy (views) jsou odpovìdné za tvorbu grafického rozhraní pro uivatele, které tvoøí na základì dat získanıch od controlleru. V ASP standartnì odpovídá jméno pohledu jménu metody controlleru, kterou je pohled vyvoláván. Vìtšina pohledù sestává z nìkolika parciálních (èásteènıch) pohledù, které jsou vyuívány na nìkolika místech.

Controllery zde zastávají funkci prostøedníka mezi pohledy a business vrstvou. Obstarávají pro pohledy relevantní data a pøi vyvolání akce uivatelem tuto akci propagují do aplikaèní logiky.

Model z MVC trojice v této vrstvì není zcela standartní, jak jsem ji pøiblíil ve \ref{sec:Architektura systému}. Podle MVC terminologie pod pojem model patøí má business i datová vrstva. Proto v této vrstvì mluvím spíše o Data modelu (co je vidìt na diagramu~\ref{fig:Architektura systému}), kterı obsahuje datové entity urèené k pøedávání mezi pohledem a controllerem. Jejich smyslem je mimo jiné odstínit závislost pohledù na konkrétních vlastnostech datovıch typù datové vrstvy a vytvoøit další vlastnosti plnìné aplikaèní logikou.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.5\textwidth]{figures/MVC}
\caption{Architektura MVC}
\label{fig:Architektura MVC}
\end{center}
\end{figure}

\section{Technologie a frameworky}

\subsection{\CSharp~ASP.NET MVC 4.0}

Tento projekt vyvíjím v jazyce \CSharp~ve vıvojovém prostøedí Visual Studio 2010. Protoe se jedná a webovì orientované øešení, je vyuito ASP.NET~\cite{}. Ze tøí\footnote{Jsou to pøístupy Web Pages, Web Forms a MVC. Více lze nalézt napøíklad na~\cite{}} pøístupù pro tvorbu s ASP.NET pouívám MVC verze 4.0. Subjektivní porovnání s Web Forms uvádím v sekci~\ref{Porovnání ASP.NET MVC a ASP.NET Web Forms}.

\subsection{ADO.NET Entity Framework}
\label{sec:Entity Framework}

Entity Framework je ORM\footnote{Objektovì relaèní mapování, technika pro pøevod dat mezi relaèní databází a objekty objektovì orientovaného programovacího jazyka} framework z rodiny ADO.NET. Slouí pro práci s daty v relaèním databázovém uloišti. Vıvoj zcela odstiòuje napøíklad od ruèního psaní SQL dotazù a pøipojování k DB. Framework je velice jednoduše a rychle pouitelnı. Doporuèil bych jeho vyuití v malıch a støednì velkıch aplikacích, kde není a tak velkı poèet dotazù na DB a tyto dotazy nemusí bıt optimalizovány do posledního klíèového slova. Více o vyuití EF v tomto projektu uvádím v sekci~\ref{sec:Implementace-Datová vrstva}.

\subsection{HTML, CSS}

Jeliko je projekt webová aplikace, základ uivatelského rozhraní tvoøí HTML a CSS. Kaskádové styly jsou optimalizovány pro prohlíeè Google Chrome, avšak kontrolovány byly i ve Firefoxu a Opeøe. Dodatek k nynìjšímu stavu viz. závìr~\ref{}.

\subsection{Javascript, jQuery}

Pro zajištìní dodateèné interaktivity a operací aplikace na stranì uivatele je vyuito Javascriptu a nadstavbového frameworku jQuery~\cite{JQuery}. Pro zjednodušení práce s Cookies (vyuité napø. pro uchování seznamu srolovanıch otázek pøi editaci formuláøe) je vyuito pluginu Cookie~\cite{jQueryCookiePlugin}.

\subsection{MarkItUp a Wiki .NET Parser}

Formátování skript~(sekce \ref{sec:Skripta}) je øešeno pomocí Wiki znaèkování. Aby mìl uivatel znaèkování co nejvíce ulehèené, je vyuito editoru MarkItUp!~\cite{MarkItUp}. Je to velice pøizpùsobitelnı a flexibilní editor jakéhokoli kódu. V tomto pøípadì upravenı pro úpravu Wiki syntaxe.

Pro pøevod stránky s Wiki znaèkováním do HTML je vyuit Wiki .NET Parser~II~\cite{WikiNETParser}. Jeho pouití je velice jednoduché, staèí zavolat metodu \icode{ConvertToHTML} s parametrem Wiki-formátovaného textu. Vrácenou hodnotou je pak pøipravenı HTML kód.

\subsection{Google Data API}

K exportu vısledkù formuláøe do Google Formuláøù~(FP\ref{FP:Podpora exportu vısledkù formuláøù do Google Formuláøù}) se pøedpokládá vyuítí Google API. Pro tento úèel existuje knihovna Google Data API .NET Client Library~\cite{GoogleDataAPI}, která obsahuje funkcionalitu pro volání Google API z prostøedí .NET.

%*****************************************************************************
\chapter{Implementace}

\section{Datová vrstva}
\label{sec:Implementace-Datová vrstva}

Pro implementaci datové vrstvy aplikace jsem pouil Entity Framework (viz.~\ref{sec:Entity Framework}). Zvolil jsem pøístup Model First Development. Podle mì je to vıbornı kompromis mezi Code First a Database First øízeném vıvoji. Mám díky nìmu plnou kontrolu nad strukturou vytváøené databáze a zároveò nad generovanımi tøídami.

Model First Development je jedním z postupù pøi vıvoji datové vrstvy. Zaplòuje mezeru mezi Code First a Database First vıvoji. Pøi Code First postupu se nejdøíve napíše kód všech datovıch entit a Entity Framework poté automaticky vygeneruje strukturu potøebné databáze. Naopak pøí Database First vıvoji se nejdøíve vytvoøí kompletní databáze, na jejím základì vygeneruje EF odpovídající tøídy v kódu. Pøi Model First se nevytváøí ani struktura DB, ani samotnı kód, ale vše se zakresluje do diagramu Entity Data Modelu~(\ref{fig:Entity Data Model}). Vıvojáø je tedy po celou dobu v roli architekta systému, protoe se vlastnì stále pohybuje v UML diagramu. Pøesto má díky mnoství nastavení ovlivòovat struktutu generované DB i generovaného kódu tøíd.

Všechny moné nedostatky skriptu databáze lze vyøešit pøidáním databázového projektu a importem vygenerovaného skriptu do nìj. V takovém projektu lze mít další skripty napøíklad pro spuštìní pøed a po vyvolání hlavního skriptu. Post-deployment skriptu vyuívám také pro automatické vytvoøení základních záznamù (èíselníky, administrátor), èím mì kadé nasazení databáze stojí pouhé dvì kliknutí myší.

Potøebné úpravy generovaného kódu tøíd lze jednoduše provést pomocí èásteènıch (partial) tøíd. Napøíklad u entit obsahujících hodnotu èíselníku toho vyuívám pro navázání enumerátoru v kódu, pøedstavujícího danı databázovı èíselník. Nikde jinde v kódu pak tedy nemusím øešit ádné èíselníkové objekty a identifikátory vztahující se k databázi.

Ve své implementaci datové vrstvy nevyuívám monosti nastavit kaskádní mazání poloek v databázi, všechna taková mazání je tedy nutné provádìt \uv{ruènì} v business vrstvì. Je to hlavnì z dùvodu zamezení vzniku všelijakıch chyb z nepozornosti a neprostudování všech monıch relací pøed zásahem do kódu. Je tedy nutné mít v metodách pro mazání pár øádkù kódu navíc, ale tím jsou všechny vykonávané akce patrné a pøípadnì lze nìjaké další akce pøi mazání vyvolat.

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/EntityDataModel}
\caption{Entity Data Model}
\label{fig:Entity Data Model}
\end{center}
\end{figure}

\clearpage
\section{Práva uivatelù}
\label{sec:Práva uivatelù}

Práva uivatelù se v tomto systému odvíjí od role, ve které se danı uivatel nachází. Není zde potøeba nastavovat kadému uivateli specifická práva, protoe role pøesnì definují jeho vztah k informacím v systému a operacím s nimi. To je rozdíl napøíklad od vnitrofiremních IS, kde je potøeba kadému uivateli mìnit práva pro pøístup k datùm a jednotlivım modulùm.

Pøesto jsou ale práva implementována tak, aby v pøípadì budoucí potøeby (a zde také pro ukázkové akademické úèely) bylo velmi jednoduché pøiøadit kadému uivateli práva nezávisle na jeho systémové roli. Abych dále mohl uvést podrobnìjší detaily, uvádím zde ukázku implementace oprávnìní uivatele:

\begin{lstlisting}[caption={[Ukázka \icode{UserPermissions} a souvisejících tøíd ]Ukázka \icode{UserPermissions} a souvisejících tøíd -- ukazuje implementaci oprávnìní uivatelskıch rolí}, label={code:Ukázka UserPermissions}]
namespace ELearning.Business.Permissions
{
	public class U``serPermissions
	{
		// ...
		public virtual bool Group_List_All { get { return false; } }
		public virtual bool Group_CreateEdit { get { return false; } }
		public virtual bool Group_Delete { get { return false; } }
		// ...
		internal static UserPermissions Get(UserTypes userType)
		{
			switch (userType)
			{
				// ...
				case UserTypes.Administrator:
					return new AdministratorPermissions();
				// ...
			}
		}
	}
	public class S``tudentPermissions : UserPermissions { /* ... */ }
	public class L``ectorPermissions : StudentPermissions { /* ... */ }
	public class A``dministratorPermissions : LectorPermissions
	{
		// ...
		public override bool Group_List_All { get { return true; } }
		public override bool Group_CreateEdit { get { return true; } }
		public override bool Group_Delete { get { return true; } }
		// ...
	}
\end{lstlisting}

Jak je z kódu~\ref{code:Ukázka UserPermissions} patrné, všechny dílèí práva (v ukázce práva na operace s uivatelskımi skupinami) jsou umístìna do vlastní property. Vrácení správné hodnoty v závislosti na roli uivatele je øešené pomocí dìdiènosti. Pro úpravu práv, aby fungovala pro jednotlivé uivatele nezávisle na rolích, je potøeba jen pøidat vlastní tøídu pro vrácení hodnoty získané ne \uv{natvrdo}, ale z relevantního záznamu z databáze.


\section{Bezpeènost}

Na bezpeènost této webové aplikace se dívám ze dvou smìrù, a to z hlediska bezpeènosti pøenášenıch dat mezi klientem a serverem a z hlediska bezpeènosti pøi práci uivatele v aplikaci. Jsou zde moná i další hlediska, napøíklad komunikace webového serveru s databázovım serverem, ale tu zde myslím není tøeba rozebírat. Pro jednoduchost pøedpokládám, e aplikace i databáze bìí na totoném serveru.

\subsection{Bezpeènost pøenášenıch dat}

Jedná se o bezpeènost pøenosu veškerıch dat, která se pøenášejí po síti (a u po LAN èi po internetu), kdy uivatel interaguje s aplikací. Nejdùleitìjší je asi moment, kdy se uivatel do aplikace pøihlašuje. Odesílá své uivatelské jméno a heslo, díky èemu je systémem identifikován a autorizován k provádìní jednotlivıch akcí.

Kdy pøihlašovací údaje zachytí útoèník (útokem známım jako MITM\footnote{Man In The Middle -- útoèník, kterı odposlouchává a pøípadnì mìní komunikaci}), získává tím identitu pravého uivatele a pøístup ke všem jeho datùm v systému. To dìlá tento útok nejnebezpeènìjším ze všech. Kdy se navíc útoèníkovi podaøí získat pøihlašovací údaje administrátora systému, dostane se rázem k veškerım datùm v systému. Navíc pro export do Google Formuláøù musí uivatel zadat údaje ke svému Google úètu, take v pøípadì odposlechnutí dojde k narušení bezpeènosti i ve zcela jiném systému ne je tento.

I kdy se ale útoèníkovi nepodaøí zachytit pøihlašovací údaje, stále má monost se hodnì vìcí dozvìdìt. Pøi zachycení komunikace vidí všechny informace, které si uivatel v danou chvíli prohlíí èi zadává.

Naštìstí se dá útokùm lehce zabránit, a to zavedením komunikace pøes HTTPS namísto HTTP, co se øeší na úrovni webového serveru. Pøi komunikaci pøes HTTPS je vyuito protokolu SSL, kterı s vyuitím serverového certifikátu veškerou komunikaci šifruje.

\subsection{Bezpeènost pøi práci v aplikaci}

Zde se jedná o bezpeènost interakce uivatele s rozhraním aplikace, tzn. zobrazování informací, pøidávání a úprava dat, to vše podmínìné stupnìm oprávnìní uivatele a jeho pøiøazením do skupin.

V aplikaci je implementováno \uv{dvoustupòové} zabezpeèení. Prvním stupnìm je kontrola oprávnìní uivatele na úrovni prezentaèní vrstvy. Pøístup na jednotlivé stránky je regulován pomocí zavedeného atributu \icode{AuthorizeUserType}, kterı jsem pøipojil ke všem metodám controllerù. Pøedáním parametru \icode{UserType} je urèen nejniší stupeò oprávnìní pro pøístup na danou url zastupovanou názvem metody. Pøi neoprávnìném pokusu o pøístup na url je atributem vyhozena vıjimka typu \icode{PermissionException}. Bìnì by se uivatel na takovouto url vùbec dostat nemìl, protoe stejná politika je implementována ve views, èím adresa takové url není uivateli dostupná.

\begin{lstlisting}[caption={Pouití atributu \icode{AuthorizeUserType}}]
[AuthorizeUserType(UserType = UserTypes.Lector)]
public ActionResult Create()
{
	// ...
}
\end{lstlisting}

% TODO Pridat screenshot pri Permission Exception (po doladeni GUI)

Druhım stupnìm je kontrola oprávnìní v samotné business vrstvì. Všechny operace nad daty zde obsahují ovìøují práva na vykonání pomocí \icode{UserPermissions}, testují jestli poadovanou poloku uivatel vytvoøil èi patøí do jeho skupiny atd. Pokud práva nemá, vznikne opìt vıjimka \icode{PermissionException}.

\begin{lstlisting}[caption={Ovìøování v business vrstvì}]
public Form GetForm(int id)
{
	var result = GetSingle(f => f.ID == id);
	if (result == null)
	{
		if (Context.F``orm.Count(f => f.ID == id) > 0)
			throw new PermissionException("Form_Get");
		else
			throw new ArgumentException("Form not found");
 	}

	return result;
}
\end{lstlisting}

%*****************************************************************************
\chapter{Testování}


\section{Unit testy}

Ovìøení funkènosti hlavních tøíd a jejich metod je provedeno pomocí Unit testù. Protoe se testují hlavnì metody pro práci s daty, je vytvoøena testovací databáze speciálnì pro tyto úèely, aby nedocházelo k monım nekonzistentním datùm a zásahùm do databáze ostré.

Pro implementaci Unit testù vyuívám nástrojù integrovanıch ve Visual Studiu.

\section{Selenium testy}
\label{sec:Selenium testy}

Pomocí testovacího systému Selenium~\ref{} testuji aplikaci z pohledu uivatele. Selenium je systém, kterı ve spuštìném webovém prohlíeèi vyvolává pøedem definované akce, jako je klikání na tlaèítka a vkládání textù do pøíslušnıch polí. Lze také ovìøovat stavy jednotlivıch html elementù a mnoho dalšího. Tento testovací systém tedy simuluje chování uivatele pøi uívání systému. Díky tìmto testùm je ovìøìn jak obsah uivatelského rozhraní (dostupné akce a údaje), tak i samotné vısledky vyvolanıch akcí.

Selenium mimo jiné umoòuje pøímou integraci do projektu vyvíjeného systému. Poskytuje toti \CSharp~knihovny, skrze které lze události v prohlíeèi vyvolávat. Já jsem testy zapojil do testù podporovanıch Visual Studiem. To pøineslo obrovské vıhody, protoe testy staèí spustit stejnì jako Unit testy, èím se vytvoøí instance prohlíeèe a zapoène simulace chování uivatele. Ihned je tvoøen report s úspìchy a neúspìchy jednotlivıch dílèích testù.

Samotné scénáøe Selenium testù není nutné psát celé ruènì v kódu. Základ lze velice jednoduše vygenerovat automaticky -- staèí zapnout nahrávání akcí ve webovém prohlíeèi a chovat se jako uivatel. Nahranı scénáø události se poté vyexportuje do jednoho z podporovanıch jazykù, v mém pøípadì do \CSharp. Jedinı malı nedostatek je, e kód je generován pro NUnit~\ref{} testy, take je ho tøeba naportovat pro testy integrované do VS.

\section{Vıkonové testy}

\subsection{Aplikace}

V souèasné dobì vychází vıkonové testování aplikace pouze z pozorování a zpìtné odezvy od uivatelù pøi pilotním provozu, popsanım níe v~\ref{sec:Pilotní provoz}.
%TODO Dopsat az budou vysledky

\subsection{Databáze}

Pro testování a nalezení neoptimalizovanıch a zbyteènıch dotazù do databáze je dobré vyuít SQL Server Profiler~\cite{SQLServerProfiler}, kterı je souèástí SQL Server Performance Tools. Pøi pouití Entity Frameworku se stává, e dotazy do databáze nejsou vdy zcela optimální. Je to z dùvodu, e EF neporozumí pøesnì zámìru programátora (co tøeba ani nemùe), a napøíklad namísto jednoho dotazu s JOIN pošle zvláš dotaz pro kadı záznam v tabulce. Díky profileru lze tyto dotazy jednoduše najít a odpovìdnı kód upravit.

V tomto projektu jsem zatím SQL profileru nevyuil, ale je to jedna z vìcí, které se budu v brzké dobì vìnovat. V této chvíli není toti optimalizace dotazù do DB stìejní, na jednotlivıch stránkách aplikace teoreticky není nic, co by mohlo i v nejhorším pøípadì systém viditelnım zpùsobem zpomalit. Ovšem lepší je všechny dotazy optimalizovat ještì pøed tím, ne se bude systém dále rozrùstat a plnit velkım mnostvím dat.

\section{Pilotní provoz}
\label{sec:Pilotní provoz}

%*****************************************************************************
\chapter{Nasazení}
\label{chp:Nasazení}

Nasazení aplikace je patrné z obrázku~\ref{fig:Diagram nasazení}. Uivatel potøebuje internetovı prohlíeè se zapnutou podporou Javascriptu. Jeho pomocí se pøipojuje k serveru, na kterém je nasazena aplikace.

Pro správnı bìh aplikace musí bıt na serveru nainstalován .NET Framework verze alespoò 4.0. Jako datové uloištì aplikace poaduje databázovı server Microsoft SQL Server verze alespoò 2005. Databázovı server mùe bıt nasazen i na vzdáleném serveru.

Popis postupu nasazení a instalace uvádím v instalaèní pøíruèce v pøíloze~\ref{appendix:Instalaèní pøíruèka}.

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/DeploymentDiagram}
\caption{Diagram nasazení}
\label{fig:Diagram nasazení}
\end{center}
\end{figure}

%*****************************************************************************

\chapter{Závìr}

V této bakaláøské práci jsem vytvoøil funkèní základ e-learningového portálu s nìkterımi specifickımi poadavky zadavatele (\ref{subs:Poadavky zadavatele}).

%V Internet Exploreru~\cite{} bohuel nevypadají zcela správnì, ale myslím e %optimalizace pro všechny prohlíeèe pøesahuje rozsah nynìjšího, dùleitìjšího %vıvoje, a plánuji vyuít


\section{Další vıvoj}

S dalším vıvojem systému poèítám metodou dog fooding\footnote{Programátoøi pouívají vyvíjenı software v roli koncového uivatele}. Bìhem uívání pøi vıuce se budou jistì stále rodit nové poadavky a moné zmìny stávající funkcionality.

\section{Moná rozšíøení}

\subsection{Formuláøe}

Vygenerování formuláøe jen s urèitım poètem otázek

\subsection{Otázky}
\label{sec:Moná rozšíøení sub:Otázky}
Monost pøiøadit k textu otázky obrázek.

\subsection{E-mailové notifikace}

\section{Porovnání ASP.NET MVC a ASP.NET Web Forms}
\label{Porovnání ASP.NET MVC a ASP.NET Web Forms}

%*****************************************************************************

\bibliographystyle{csplainnat}

\bibliography{reference}


%*****************************************************************************
%*****************************************************************************
\appendix

%*****************************************************************************

\chapter{Seznam pouitıch zkratek}

\begin{description}
\item[LAN] Local Area Network
\item[MITM] Man In The Middle
\item[HTTP] HyperText Transfer Protocol
\item[HTTPS] HyperText Transfer Protocol Secure
\item[IS] Informaèní Systém
\item[GPL] General Public License
\item[MVC] Model View Controller
\item[CRUD] Create Read Update Delete
\item[VS] Visual Studio
\item[EF] Entity Framework
\item[UML] Unified Modeling Language
\item[DB] Databáze
\item[ORM] Object/Relational Mapping
\item[SQL] Structured Query Language
\item[HTML] HyperText Markup Language
\item[CSS] Cascading Style Sheets)
\item[FTP] File Transfer Protocol
\end{description}
\vdots

%*****************************************************************************

\chapter{UML}

\section{Popis pøípadù uití}
\label{appendix:Pøípady uití}

\noindent
\sectionline
\textbf{Název:} Pøíhlásit se do systému\\
\textbf{Aktéøi:} Student, Lektor, Administrátor\\
\textbf{Hlavní scénáø:}
\begin{enumerate}
\item Uivatel otevøe stránky systému pomocí webového prohlíeèe
\item Uivatel zvolí Pøíhlásit se
\item Systém zobrazí formuláø pro zadání pøihlašovacích údajù
\item Uivatel zadá pøihlašovací údaje a potvrdí stiskem tlaèitka Pøihlásit se
\item Systém zobrazí domácí obrazovku uivatele
\end{enumerate}
\textbf{Alternativní scénáø 1:} Uivatel zadá špatné pøihlašovací údaje v bodì 4
\begin{enumerate}
\setcounter{enumi}{4}
\item Systém zobrazí chybové hlášení
\item Pokraèuje se bodem 4
\end{enumerate}
\textbf{Vısledek:} Uivatel je pøihlášen do systému

\noindent
\sectionline %-----------------------------------------------------------------
\textbf{Název:} Vytvoøit novı formuláø\\
\textbf{Aktéøi:} Lektor, Administrátor\\
\textbf{Vstupní podmínky:} 
\begin{itemize}
\item Uivatel je pøihlášen do systému
\end{itemize}
\textbf{Hlavní scénáø:}
\begin{enumerate}
\item Uivatel zvolí Vytvoøit novı formuláø
\item Systém zobrazí formuláø pro zadání parametrù vytváøeného formuláøe
\item Uivatel zadá poadované parametry a potvrdí tlaèítkem Vytvoøit
\item Systém vytvoøí novı formuláø na základì zadanıch parametrù
\item Systém zobrazí obrazovku pro práci s otázkami vytvoøeného formuláøe
\end{enumerate}
\textbf{Alternativní scénáø 1:} Uivatel zadá špatné parametry v bodì 3
\begin{enumerate}
\setcounter{enumi}{3}
\item Systém zobrazí chybové hlášení o špatnì vloenıch parametrech
\item Pokraèuje se bodem 3
\end{enumerate}
\textbf{Alternativní scénáø 2:} Uivatel zruší vytváøení formuláøe zvolením jiné akce\\
\textbf{Vısledek:} Systém obsahuje novı formuláø

\noindent
\sectionline %-----------------------------------------------------------------
\textbf{Název:} Pøidat otázku\\
\textbf{Aktéøi:} Lektor, Administrátor\\
\textbf{Vstupní podmínky:} 
\begin{itemize}
\item Uivatel je pøihlášen do systému
\item V systému existuje formuláø ve stavu Neaktivní editovatelnı nebo Aktivní nevyplnìnı
\end{itemize}
\textbf{Hlavní scénáø:}
\begin{enumerate}
\item Uivatel zvolí formuláø, ke kterému chce otázku pøidat
\item Systém zobrazí obrazovku pro práci s otázkami zvoleného formuláøe
\item Uivatel zvolí poadovanı typ otázky a stiskne tlaèítko Pøidat
\item Systém pøidá do kolekce otázek formuláøe novou otázku zvoleného typu
\end{enumerate}
\textbf{Vısledek:} Formuláø obsahuje novou otázku

\noindent
\sectionline %-----------------------------------------------------------------
\textbf{Název:} Vyplnit formuláø\\
\textbf{Aktéøi:} Student\\
\textbf{Vstupní podmínky:} 
\begin{itemize}
\item Uivatel je pøihlášen do systému
\item V systému existuje formuláø ve stavu Aktivní nevyplnìnı nebo Aktivní vyplnìnı
\item Formuláø je pøiøazen do stejné skupiny jako uivatel
\item Formuláø byl uivatelem vyplnìn ménìkrát ne je jeho maximální poèet vyplnìní
\end{itemize}

\clearpage

\textbf{Hlavní scénáø:}
\begin{enumerate}
\item Uivatel zvolí formuláø k vyplnìní
\item Systém zobrazí detailní informace o vybraném formuláøi
\item Uivatel spustí vyplòování stiskem tlaèítka Start
\item Systém vygeneruje instanci formuláøe na základì jeho parametrù
\item Systém skryje hlavní ovládací prvky a zobrazí vygenerovanı formuláø
\item Uivatel vyplní své odpovìdi na otázky formuláøy
\item Uivatel potvrdí odpovìdi stiskem Odeslat
\item Systém odpovìdi zaznamená, potvrdí pøijetí a opìt zobrazí hlavní ovládací prvky
\end{enumerate}
\textbf{Alternativní scénáø 1:} Vypršel èasovı limit formuláøe bìhem vyplòování v bodì 6
\begin{enumerate}
\setcounter{enumi}{6}
\item Systém ukonèí vyplòování formuláøe
\item Pokraèuje se bodem 8 hlavního scénáøe
\end{enumerate}
\textbf{Vısledek:} Systém obsahuje novou instanci formuláøe s odpovìïmi na otázky

\noindent
\sectionline %-----------------------------------------------------------------
\textbf{Název:} Exportovat vısledky formuláøe do Google Dokumentù\\
\textbf{Aktéøi:} Lektor, Administrátor\\
\textbf{Vstupní podmínky:} 
\begin{itemize}
\item Uivatel je pøihlášen do systému
\item V systému existuje formuláø
\end{itemize}
\textbf{Hlavní scénáø:}
\begin{enumerate}
\item Uivatel zvolí zobrazení vısledkù formuláøe k exportu
\item Systém zobrazí pøehled vyplnìní formuláøe
\item Uivatel stiskne tlaèítko Export vısledkù do Google Dokumentù
\item Systém zobrazí formuláø pro zadání pøihlašovacích údajù Google úètu
\item Uivatel vyplní údaje a potvrdí export stiskem Exportovat
\item Systém exportuje vısledky do nového dokumentu v zadaném Google úètu
\end{enumerate}
\textbf{Vısledek:} Uivatelùv Google úèet obsahuje novı dokument s vısledky formuláøe

\noindent
\sectionline %-----------------------------------------------------------------

%*****************************************************************************
\chapter{Instalaèní pøíruèka}
\label{appendix:Instalaèní pøíruèka}

Zde uvádím popis instalace (nasazení) aktuální verze aplikace asi nejjednodušším zpùsobem, a to za vyuití Visual Studia. Pro úspìšné nasazení je tøeba mít k dispozici aplikaèní a databázovı server, jak je uvedeno v kapitole~\ref{chp:Nasazení}.

Nejdøíve je tøeba zvolit konfiguraci pro zveøejòování, tzn. Release nebo nìkterou z mnou pøedpøipravenıch. Na obrázku~\ref{fig:Volba konfigurace pro nasazení} je zachycena volba konfigurace pro nasazení na ukázkovı server projektu~(\ref{sec:}).

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/InstallGuide_Configuration}
\caption{Volba konfigurace pro nasazení}
\label{fig:Volba konfigurace pro nasazení}
\end{center}
\end{figure}

Pro nasazení databáze je tøeba nejprve zkontrolovat nastavení databázového projektu. Akce pro Deployment by mìla bıt nastavena na vytvoøení skriptu a automatické vytvoøení databáze, jak je vidìt na obrázku~\ref{fig:Nastavení databázového projektu}. V poli \textit{Target connection} by mìly bıt vyplnìny údaje nutné k pøipojení k poadovanému DB serveru a v poli \textit{Target database name} jméno vytváøené databáze. Po kontrole údajù staèí jen vybrat v menu \textit{Build}~\textrightarrow~\textit{Deploy Database} a celá databáze i s poèáteèními daty bude automaticky nasazena.

\clearpage

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/InstallGuide_DBSettings}
\caption{Nastavení databázového projektu}
\label{fig:Nastavení databázového projektu}
\end{center}
\end{figure}

Nasazení samotného portálu je stejnì jednoduché. Po vybrání projektu \textit{ELearning} je v menu \textit{Build} zpøístupnìna akce \textit{Publish ELearning}. Vyvolané dialogové okno je vidìt na obrázku~\ref{fig:Diagram pro publikování aplikace}. K nasazení je vyuito metody \textit{FTP}, která nahrává aplikaèní soubory pøes FTP spojení na zadanou adresu. Po vyplnìní pøístupovıch údajù a stisku tlaèítka \textit{Publish} dojde k nasazení aplikace.

\begin{figure}[h]
\begin{center}
\includegraphics[width=0.6\textwidth]{figures/InstallGuide_Publish}
\caption{Diagram pro publikování aplikace}
\label{fig:Diagram pro publikování aplikace}
\end{center}
\end{figure}

%*****************************************************************************
\chapter{Uivatelská pøíruèka}

%*****************************************************************************

\chapter{Unity Application Block tutoriál}

Pro dependecy injection vyuívám NuGet balíèku Unity Application Block. Zde bych chtìl pøiblíit, jak jej zaèlenit do projektu.

Nejdøíve je nutné do projektu nainstalovat Unity NuGet balíèek (v menu Visual Studia zvolit Tools > Library Package Manager > Manage NuGet Packages..., v dialogovém oknì vyhledat Unity a potvrdit instalaci).



Pro pøístup k Unity definuji podobnì jako v~\cite{HowToUseUnityContainer} interface \icode{IUnityContainerAccessor} s následujícím pøedpisem:

\begin{lstlisting}[caption={Pøedpis rozhraní \icode{IUnityContainerAccessor}}]
public interface IUnityContainerAccessor
{
	IUnityContainer UnityContainer { get; }
}
\end{lstlisting}

%*****************************************************************************
\chapter{Obrazová pøíloha}

\begin{figure}[h]
\begin{center}
\includegraphics[width=1\textwidth]{figures/MoodleQuestionTypes}
\caption{Typy otázek v systému Moodle~\cite{MoodleVycetTypuOtazek}}
\label{fig:Typy otázek v systému Moodle}
\end{center}
\end{figure}

%*****************************************************************************
\chapter{Obsah pøiloeného CD}


%*****************************************************************************
\end{document}
